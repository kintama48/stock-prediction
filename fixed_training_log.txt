2025-08-25 17:54:08,173 - INFO - Model created with 25,521,772 parameters (25,521,772 trainable)
2025-08-25 17:54:09,393 - INFO - Optimizer: AdamW, LR: 5e-05
2025-08-25 17:54:09,393 - INFO - Scheduler: StepLR (step_size=1000, gamma=0.9)
2025-08-25 17:54:09,393 - INFO - ================================================================================
2025-08-25 17:54:09,393 - INFO - 🚀 STARTING FIXED TRAINING SESSION
2025-08-25 17:54:09,393 - INFO - ================================================================================
2025-08-25 17:54:09,393 - INFO - Device: cuda
2025-08-25 17:54:09,393 - INFO - Max Steps: 10000
2025-08-25 17:54:09,393 - INFO - Validation Interval: 200
2025-08-25 17:54:09,394 - INFO - 
📈 EPOCH 1/50
2025-08-25 17:54:09,394 - INFO - --------------------------------------------------
🚀 Starting Fixed Training Pipeline
============================================================
{
  "hidden_size": 512,
  "num_heads": 16,
  "num_layers": 8,
  "intermediate_size": 2048,
  "dropout": 0.1,
  "sequence_length": 60,
  "prediction_horizon": 5,
  "batch_size": 32,
  "learning_rate": 5e-05,
  "weight_decay": 0.01,
  "num_epochs": 50,
  "max_steps": 10000,
  "val_interval": 200,
  "log_interval": 50,
  "num_workers": 4,
  "checkpoint_dir": "hftraining/checkpoints/fixed"
}

📊 Loading data...
Downloading stock data...
  • AAPL
Error loading data: Cannot set a DataFrame with multiple columns to the single column volume_ratio
Data splits: Train=(4000, 21), Val=(500, 21)

🔄 Creating data loaders...

⚙️  Setting up trainer...

🎯 Starting training...
Traceback (most recent call last):
  File "/media/lee/crucial2/code/stock/hftraining/train_fixed.py", line 564, in <module>
    main()
  File "/media/lee/crucial2/code/stock/hftraining/train_fixed.py", line 547, in main
    trainer.train(train_loader, val_loader)
  File "/media/lee/crucial2/code/stock/hftraining/train_fixed.py", line 332, in train
    metrics = self.train_step(batch)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/media/lee/crucial2/code/stock/hftraining/train_fixed.py", line 230, in train_step
    inputs = batch['inputs']
             ~~~~~^^^^^^^^^^
KeyError: 'inputs'
